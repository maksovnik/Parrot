import random
from Crypto.Cipher import AES
from Crypto.Protocol import HKDF
from Crypto.Hash import SHA512
import binascii

G=2
n = 19734900040940404664644305615517238200212737175723279495859664156912668581028626844565624073416930176658640903580121503424187075146581792121169366619768962912386932913035391380374152854390654320238159350999950760196043670547034246552641205036156304454114742591861285315528651792639509005687918434719606041598759632146313746054686415079747239188388174259165477084624911519924254250193142157594028121418869456159224309692587572801705369036200731722831092555576381490521445478978824802735386346431892032437482199817068803449197481051775442393900111881542447488099020087307856765855565090642652903369470287423296353531069

def genKP():
    private=random.randint(1,n)
    public=pow(G,private,n)
    return private,public

alice=genKP()
bob=genKP()

alicePublic=alice[1]
bobPublic=bob[1]

key1=pow(bobPublic,alice[0],n)
key2=pow(alicePublic,bob[0],n)


key3 = HKDF(str(key1).encode(), 32, None, SHA512, 1)
key4 = HKDF(str(key2).encode(), 32, None, SHA512, 1)

cipher1=AES.new(key3,AES.MODE_EAX)


ct=cipher1.encrypt(b'Hey')

print(ct)
